Отлично, на основе ваших ответов подготовлю структурированный документ. Заполню пункты, где информации достаточно, а в описаниях моделей дам шаблоны с пояснениями, которые вы сможете детализировать.

---

### **Требования к оформлению проекта**

#### **1. Краткое описание проекта**

**1.1. Ф.И.О. разработчиков**
Эйзерман Александр Николаевич

**1.2. Группа**
Д-Э 311

**1.3. Тема проекта**
Сервис для просмотра, назначения и изменения аудиторов

**1.4. Цель проекта**
Сделать процесс аудирования в компании прозрачнее, обеспечить равномерное распределение нагрузки по аудиторам, собрать статистику по количеству попыток до успешного прохождения аудита.

**1.5. Задачи проекта**
1. Реализовать систему управления сервисами с указанием GitLab-репозиториев.
2. Создать механизм управления пользователями с ролями: Разработчик, Менеджер, Админ.
3. Реализовать поиск подходящих аудиторов по имени сервиса или ссылке на Merge Request.
4. Реализовать проверку по MR и выбранному аудитору из списка, может ли он его аудировать.
5. Реализовать отображение возможных списков аудиторов у выбранного сервиса, или для MR в порядке от самого свободного до самого нагруженного.
6. Интегрировать систему с Jira для отслеживания нагрузки аудиторов через webhook.
7. Собирать статистику по количеству попыток до успешного прохождения аудита.

**1.6. Аннотация**
Сервис автоматизирует подбор и назначение аудиторов для код-ревью (аудита) Merge Request в проектах компании. Ключевые возможности включают интеллектуальный поиск доступных аудиторов на основе сервиса или MR, проверку их прав, ранжирование по текущей нагрузке и интеграцию с GitLab и Jira для актуальности данных. Основные пользователи — менеджеры и разработчики — получают инструмент для быстрого назначения аудитов, что повышает эффективность и прозрачность процессов разработки. Система также предоставляет аналитику по количеству попыток прохождения аудита для выявления узких мест.

---

### **2. Документация**

#### **2.1. Подробное описание проекта**
Сервис представляет собой классическое трехзвенное веб-приложение (клиент-сервер).
*   **Frontend:** Веб-интерфейс на JavaScript (рекомендуется фреймворк, например, React или Vue.js) для взаимодействия пользователей.
*   **Backend:** RESTful API сервер на языке Go, обрабатывающий бизнес-логику, авторизацию и интеграции.
*   **Database:** Реляционная база данных MySQL для хранения информации о пользователях, сервисах, MR, аудитах и статистике.
*   **Интеграции:**
    *   **GitLab:** Взаимодействие через REST API для получения информации о Merge Request, репозиториях и пользователях. Возможно использование webhook для отслеживания событий с MR.
    *   **Jira:** Интеграция через REST API для получения задач, связанных с аудиторами, что позволяет оценить их текущую нагрузку.
*   **Основной сценарий использования:**
    1.  Разработчик создает Merge Request в GitLab.
    2.  Текущий назначенный аудитор занят (нагрузка из Jira, статус в системе).
    3.  Разработчик или менеджер открывает сервис, вводит ссылку на MR или выбирает сервис.
    4.  Система, запросив данные из GitLab, определяет проект и находит всех пользователей с ролью "Аудитор", у которых есть права на этот проект.
    5.  Система запрашивает из Jira текущее количество активных задач у каждого кандидата, ранжирует их по возрастанию нагрузки.
    6.  Пользователю выдается ранжированный список доступных аудиторов.
    7.  Пользователь выбирает аудитора и назначает аудит. Система фиксирует назначение и может отправить уведомление.

#### **2.2. Ментальная карта**
```
Сервис аудирования
├── Пользователи
│   ├── Роли (Разработчик, Менеджер, Аудитор, Админ)
│   ├── Атрибуты (ID, Имя, Уровень доступа, Токены для API)
│   └── Действия (Назначить аудит, Просмотреть статистику)
├── Сервисы (Проекты)
│   ├── Название
│   ├── Ссылка на GitLab репозиторий
│   └── Список аудиторов с правами
├── Merge Request (MR)
│   ├── Ссылка на GitLab
│   ├── Статус (Ожидает, Назначен, Завершен)
│   └── Связанный сервис
├── Аудит
│   ├── MR (ссылка)
│   ├── Аудитор (пользователь)
│   ├── Дата назначения/завершения
│   ├── Результат (Успех/Неудача)
│   └── Счетчик попыток
├── Интеграции
│   ├── GitLab (получение данных о MR)
│   └── Jira (получение нагрузки аудиторов)
└── Статистика
    ├── Попытки до успешного аудита (по сервисам/командам)
    └── Нагрузка аудиторов (графики/отчеты)
```
Карта отражает ключевые доменные сущности системы и их взаимосвязи, начиная от пользователей и заканчивая аналитикой.

#### **2.3. Модель в нотации IDEF0 (контекстная диаграмма A-0)**
```mermaid
flowchart TD
    %% Внешние элементы
    Политики["Политики аудита<br>Ролевая модель"]
    Заявка["Заявка на MR (ссылка)"]
    Механизмы["База данных<br>API GitLab/Jira"]
    Назначенный["Назначенный аудитор"]
    Статистика["Обновленная статистика"]
    Уведомления["Уведомления"]
    
    %% Основной процесс A0
    subgraph A0
        Процесс["A0: Управление процессом аудита MR"]
    end
    
    %% Связи
    Политики --> A0
    Заявка --> A0
    
    A0 --> Назначенный
    A0 --> Статистика
    A0 --> Уведомления
    
    Механизмы --> A0
    
    %% Стилизация для соответствия IDEF0
    style A0 fill:#f9f9f9,stroke:#333,stroke-width:2px
    style Политики fill:#e6f7ff,stroke:#91d5ff
    style Заявка fill:#e6f7ff,stroke:#91d5ff
    style Механизмы fill:#f6ffed,stroke:#b7eb8f
    style Назначенный fill:#fff7e6,stroke:#ffd591
    style Статистика fill:#fff7e6,stroke:#ffd591
    style Уведомления fill:#fff7e6,stroke:#ffd591
```
Контекстная диаграмма показывает систему как единый блок (A0). **Вход** — заявка на аудит (ссылка на MR). **Выход** — результат работы системы (назначенный аудитор, данные). **Управление** — регламенты компании. **Механизмы** — техническая реализация.

#### **2.4. Фрагмент модели в нотации DFD (уровень декомпозиции A0)**
```mermaid
flowchart TD
    %% Внешние сущности
    Менеджер["Менеджер"]
    GitLab["GitLab"]
    Jira["Jira"]
    БД[("База данных")]
    
    %% Процессы
    ОбработатьЗапрос["1. ОБРАБОТАТЬ ЗАПРОС<br>на назначение аудита"]
    НайтиИРанжировать["2. НАЙТИ И РАНЖИРОВАТЬ<br>подходящих аудиторов"]
    Назначить["3. НАЗНАЧИТЬ АУДИТОРА<br>и сохранить результат"]
    
    %% Потоки данных
    Менеджер -- "Ссылка на MR" --> ОбработатьЗапрос
    ОбработатьЗапрос -- "Запрос данных MR" --> GitLab
    GitLab -- "Данные MR, проект" --> ОбработатьЗапрос
    ОбработатьЗапрос -- "ID проекта, права" --> НайтиИРанжировать
    НайтиИРанжировать -- "Запрос задач" --> Jira
    Jira -- "Данные о нагрузке" --> НайтиИРанжировать
    НайтиИРанжировать -- "Ранжированный список" --> Менеджер
    Менеджер -- "Выбор аудитора" --> Назначить
    Назначить -- "Сохранить назначение" --> БД
    
    %% Потоки данных между процессами
    НайтиИРанжировать -- "Список кандидатов с рейтингом" --> Назначить
    ОбработатьЗапрос -- "Проверенные данные MR" --> Назначить
```
DFD показывает потоки данных между процессами (овалы) и внешними сущностями (прямоугольники). Видно, как данные перетекают от пользователя через процессы взаимодействия с GitLab и Jira к сохранению в БД.

#### **2.5. Модель в нотации BPMN**
```mermaid
flowchart TD
    %% Пулы и дорожки
    subgraph P1 [Пользователь]
        A1[Менеджер/Разработчик]
    end
    
    subgraph P2 [Система]
        A2[Шлюз: Валидация MR]
        A3[Получить данные из GitLab]
        A4[Определить сервис и права]
        A5[Запросить нагрузку аудиторов из Jira]
        A6[Отфильтровать и ранжировать аудиторов]
        A7[Показать список пользователю]
        A8[Назначить в системе]
        A9[Обновить статус MR]
        A10[Записать в БД]
        A11[Собрать статистику]
    end
    
    %% Старт и события
    Start(("Старт"))
    End1(("Конец"))
    End2(("Конец"))
    
    %% Основной поток
    Start --> A1
    A1 --> A2
    
    %% Шлюз валидации
    A2 -- "Да" --> A3
    A2 -- "Нет" --> A12[Показать ошибку]
    A12 --> End1
    
    %% Основной процесс
    A3 --> A4
    A4 --> A5
    A5 --> A6
    A6 --> A7
    A7 --> A13[Пользователь выбирает аудитора]
    A13 --> A8
    
    %% Параллельные операции
    A8 --> A9
    A8 --> A10
    
    A9 --> A11
    A10 --> A11
    A11 --> End2
    
    %% Стилизация для BPMN
    style Start fill:#52c41a,stroke:#237804,color:white
    style End1 fill:#ff4d4f,stroke:#a8071a,color:white
    style End2 fill:#ff4d4f,stroke:#a8071a,color:white
    style A2 fill:#fff566,stroke:#d4b106
    style A12 fill:#ffccc7,stroke:#ff7875
    style A13 fill:#d6e4ff,stroke:#85a5ff
    
    %% Процессы
    style A1 fill:#d6e4ff,stroke:#85a5ff
    style A3 fill:#d6e4ff,stroke:#85a5ff
    style A4 fill:#d6e4ff,stroke:#85a5ff
    style A5 fill:#d6e4ff,stroke:#85a5ff
    style A6 fill:#d6e4ff,stroke:#85a5ff
    style A7 fill:#d6e4ff,stroke:#85a5ff
    style A8 fill:#d6e4ff,stroke:#85a5ff
    style A9 fill:#d6e4ff,stroke:#85a5ff
    style A10 fill:#d6e4ff,stroke:#85a5ff
    style A11 fill:#d6e4ff,stroke:#85a5ff
```
BPMN визуализирует бизнес-процесс с точки зрения участников и последовательности действий. Видны альтернативные пути (ошибка), параллельные действия (обновление статуса и запись) и интеграции (GitLab, Jira).

#### **2.6. Модели в нотации UML**

**2.6.1. Диаграмма классов (Структурная)**
```mermaid
classDiagram
    class User {
        +int id
        +string name
        +Role role
        +List~Project~ accessibleProjects
        +bool canAudit(Project p)
    }
    class Project {
        +int id
        +string name
        +string gitlabUrl
        +List~User~ auditors
    }
    class MergeRequest {
        +int id
        +string gitlabLink
        +Project project
        +Audit currentAudit
        +Status status
    }
    class Audit {
        +int id
        +User auditor
        +MergeRequest mr
        +DateTime assignedAt
        +DateTime? completedAt
        +Result result
        +int attemptCount
    }
    User "1" -- "*" Project : имеет доступ к
    Project "1" -- "*" MergeRequest : содержит
    MergeRequest "1" -- "0..1" Audit : имеет текущий
    Audit "1" -- "1" User : назначен на
    Audit "1" -- "1" MergeRequest : проводится для
```
Показывает основные сущности, их атрибуты, методы и связи. Например, связь между `Audit` и `MergeRequest` — "проводится для" (один к одному).

**2.6.2. Диаграмма вариантов использования (Поведенческая)**
```mermaid
graph TD
    subgraph "Диаграмма вариантов использования"
        M[Менеджер]
        A[Аудитор]
        AD[Администратор]
        S["Система (GitLab/Jira)"]
        
        M --> UC1[Назначить аудитора по MR]
        M --> UC2[Просмотреть статистику по сервису]
        A --> UC3[Просмотреть свои назначенные аудиты]
        A --> UC4[Завершить аудит с результатом]
        AD --> UC5[Управлять пользователями]
        AD --> UC6[Управлять сервисами]
        S --> UC7[Отправить событие о новом MR]
        S --> UC8[Предоставить данные о нагрузке]
        
        UC1 -.-> UC9[Найти доступных аудиторов]
        UC1 -.-> UC10[Проверить права аудитора]
    end
```
Определяет, какие действия (use case) доступны каждому типу пользователя (актору). Показывает связи между use case (например, `include`).

**2.6.3. Диаграмма последовательностей (Поведенческая)**
```mermaid
sequenceDiagram
    participant Менеджер
    participant Сервис as "Сервис (Backend)"
    participant GitLab as "GitLab API"
    participant Jira as "Jira API"
    participant БД as "База данных"

    Менеджер->>Сервис: Ссылка на MR
    Сервис->>GitLab: Запрос данных MR
    GitLab-->>Сервис: Данные MR, проект
    Сервис->>Jira: Запрос задач аудитора
    Jira-->>Сервис: Данные о нагрузке
    Сервис->>БД: Запрос: найти аудиторов проекта с правами
    БД-->>Сервис: Список кандидатов
    
    Note over Сервис: Ранжирование по нагрузке из Jira
    
    Сервис-->>Менеджер: Ранжированный список
    Менеджер->>Сервис: Выбор аудитора
    Сервис->>БД: Создать запись Audit, обновить MR
    БД-->>Сервис: Подтверждение
    Сервис-->>Менеджер: Подтверждение успеха
```
Детально показывает хронологию обмена сообщениями между объектами для сценария "Назначение аудитора".

#### **2.7. ER диаграмма**
```mermaid
erDiagram
    USERS {
        int user_id PK
        varchar name
        enum role
    }
    PROJECTS {
        int project_id PK
        varchar name
        varchar gitlab_url
    }
    USER_PROJECTS {
        int user_id FK
        int project_id FK
    }
    MERGE_REQUESTS {
        int mr_id PK
        varchar gitlab_link
        int project_id FK
        enum status
    }
    AUDITS {
        int audit_id PK
        int mr_id FK
        int auditor_id FK
        datetime assigned_at
        datetime completed_at
        enum result
        int attempt_count
    }

    USERS ||--o{ USER_PROJECTS : "имеет доступ"
    PROJECTS ||--o{ USER_PROJECTS : "доступен для"
    PROJECTS ||--o{ MERGE_REQUESTS : "содержит"
    MERGE_REQUESTS ||--o| AUDITS : "проходит аудит"
    USERS ||--o{ AUDITS : "проводит"
```
Таблица `USER_PROJECTS` — это связующая таблица "многие-ко-многим" между пользователями и проектами (для хранения прав аудиторов на сервисы). Связь между `MERGE_REQUESTS` и `AUDITS` — "один-к-одному", так как у одного MR в один момент времени может быть только один активный аудит.
